<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ARIX // ADMIN</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=JetBrains+Mono:wght@500&display=swap');

        :root {
            /* Purple/Blue Theme from Image */
            --bg-grad-1: #1a0b2e;
            --bg-grad-2: #110e1b;
            --card-bg: rgba(30, 27, 46, 0.7);
            --card-border: rgba(255, 255, 255, 0.05);
            --accent: #6d28d9; /* Deep Purple */
            --accent-glow: #8b5cf6;
            --text-main: #ffffff;
            --text-dim: #9ca3af;
            --green: #10b981;
            --red: #ef4444;
            --font-main: 'Inter', sans-serif;
            --font-mono: 'JetBrains Mono', monospace;
        }

        body {
            background: linear-gradient(135deg, var(--bg-grad-1) 0%, var(--bg-grad-2) 100%);
            color: var(--text-main);
            font-family: var(--font-main);
            margin: 0;
            height: 100vh;
            overflow: hidden;
            display: flex;
            cursor: none;
        }

        /* --- CUSTOM CURSOR --- */
        #cursor {
            position: fixed; top: 0; left: 0; width: 8px; height: 8px;
            background: white; border-radius: 50%; pointer-events: none;
            z-index: 9999; mix-blend-mode: overlay;
            transform: translate(-50%, -50%);
            transition: width 0.2s, height 0.2s;
        }
        body:hover #cursor { width: 12px; height: 12px; }

        /* --- LAYOUT --- */
        #sidebar {
            width: 250px; background: rgba(0,0,0,0.2);
            border-right: 1px solid var(--card-border);
            display: flex; flex-direction: column; padding: 20px;
        }

        #main { flex: 1; padding: 40px; display: flex; flex-direction: column; }

        /* --- COMPONENTS --- */
        h1, h2 { margin: 0; font-weight: 800; letter-spacing: -0.5px; }
        
        .card {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 12px;
            padding: 20px;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
        }

        /* --- LIST --- */
        .search-bar {
            width: 100%; background: rgba(0,0,0,0.3); border: 1px solid var(--card-border);
            padding: 15px; border-radius: 8px; color: white; font-family: var(--font-main);
            outline: none; margin-bottom: 20px; cursor: none;
        }
        .search-bar:focus { border-color: var(--accent-glow); }

        .player-row {
            display: flex; align-items: center; justify-content: space-between;
            padding: 15px; margin-bottom: 10px; border-radius: 8px;
            background: rgba(255,255,255,0.02); transition: 0.2s;
            border: 1px solid transparent;
        }
        .player-row:hover { background: rgba(255,255,255,0.05); transform: translateY(-2px); border-color: rgba(255,255,255,0.1); }

        .p-info { display: flex; align-items: center; gap: 15px; }
        .p-avatar { width: 40px; height: 40px; background: var(--accent); border-radius: 8px; display: flex; align-items: center; justify-content: center; font-weight: bold; }
        
        .badge { padding: 4px 10px; border-radius: 4px; font-size: 0.75em; font-weight: bold; text-transform: uppercase; }
        .b-clean { background: rgba(16, 185, 129, 0.1); color: var(--green); }
        .b-banned { background: rgba(239, 68, 68, 0.1); color: var(--red); }

        .btn { padding: 8px 16px; border-radius: 6px; border: none; font-weight: 600; cursor: none; transition: 0.2s; }
        .btn-danger { background: var(--red); color: white; }
        .btn-ghost { background: transparent; border: 1px solid var(--card-border); color: #aaa; }
        .btn-ghost:hover { border-color: white; color: white; }

        /* --- LOGIN --- */
        #login { position: fixed; inset: 0; background: var(--bg-grad-1); z-index: 50; display: flex; justify-content: center; align-items: center; }
        
        /* --- MODAL --- */
        #modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.8); z-index: 100; justify-content: center; align-items: center; }
        
    </style>
</head>
<body>
    <div id="cursor"></div>

    <div id="login">
        <div class="card" style="width: 350px; text-align: center;">
            <h1 style="margin-bottom: 20px;">ARIX <span style="color:var(--accent-glow)">ADMIN</span></h1>
            <input type="text" id="api" value="https://sanctionbanepiconlineservicesystem.onrender.com" class="search-bar" placeholder="Server">
            <input type="password" id="pass" class="search-bar" placeholder="Password">
            <button onclick="auth()" class="btn" style="width:100%; background:var(--accent); color:white; padding:15px;">LOGIN</button>
            <p id="msg" style="color:var(--red); margin-top:10px; font-size:0.8em;"></p>
        </div>
    </div>

    <div id="dashboard" style="display:none; width:100%; height:100%;">
        <div id="sidebar">
            <h2 style="margin-bottom: 40px;">ARIX</h2>
            <div style="color: var(--text-dim); font-size: 0.9em; margin-bottom: 10px;">GENERAL</div>
            <div style="padding: 10px; background: rgba(255,255,255,0.05); border-radius: 6px; margin-bottom: 5px;">Dashboard</div>
            <div style="padding: 10px; color: var(--text-dim);">Users</div>
            <div style="padding: 10px; color: var(--text-dim);">Settings</div>
            <div style="margin-top: auto; padding: 10px; border-top: 1px solid var(--card-border);">
                <div style="font-size: 0.8em; color: var(--text-dim);">STATUS</div>
                <div style="color: var(--green);">Connected</div>
            </div>
        </div>

        <div id="main">
            <div style="display: flex; justify-content: space-between; margin-bottom: 20px;">
                <h1>Player Database</h1>
                <button onclick="refresh()" class="btn btn-ghost">REFRESH</button>
            </div>

            <div class="card" style="margin-bottom: 20px;">
                <input type="text" id="search" onkeyup="render()" class="search-bar" style="margin:0;" placeholder="Search Username or ID...">
            </div>

            <div id="list" style="overflow-y: auto; flex: 1;"></div>
        </div>
    </div>

    <div id="modal">
        <div class="card" style="width: 400px;">
            <h2 style="color:var(--red); margin-bottom: 5px;">Sanction User</h2>
            <div style="color:var(--text-dim); margin-bottom: 20px;">Target: <span id="m-target" style="color:white"></span></div>
            
            <input type="text" id="m-reason" class="search-bar" placeholder="Reason">
            <input type="number" id="m-time" class="search-bar" placeholder="Minutes (0 = Perma)">
            
            <div style="display: flex; gap: 10px;">
                <button onclick="closeModal()" class="btn btn-ghost" style="flex:1;">Cancel</button>
                <button onclick="commitBan()" class="btn btn-danger" style="flex:1;">Execute</button>
            </div>
        </div>
    </div>

    <script>
        // CURSOR
        const c = document.getElementById('cursor');
        document.addEventListener('mousemove', e => { c.style.left = e.clientX+'px'; c.style.top = e.clientY+'px'; });

        // LOGIC
        let API="", TOKEN="", DB=[], SEL="";

        async function auth() {
            let u = document.getElementById('api').value.replace(/\/$/,"");
            let p = document.getElementById('pass').value;
            try {
                let r = await fetch(u+'/api/players', {headers:{'x-admin-auth':p}});
                if(!r.ok) throw "Fail";
                API=u; TOKEN=p; DB=(await r.json()).players;
                document.getElementById('login').style.display='none';
                document.getElementById('dashboard').style.display='flex';
                render();
            } catch(e) { document.getElementById('msg').innerText="Connection Failed"; }
        }

        async function refresh() {
            let r = await fetch(API+'/api/players', {headers:{'x-admin-auth':TOKEN}});
            DB = (await r.json()).players;
            render();
        }

        function render() {
            let l=document.getElementById('list'), s=document.getElementById('search').value.toLowerCase();
            l.innerHTML="";
            
            DB.filter(p => (p.username||"").toLowerCase().includes(s) || p.productUserId.includes(s)).forEach(p => {
                // FILTER OUT BAD IDs
                if(p.productUserId === "undefined" || !p.productUserId) return;

                let div = document.createElement('div');
                div.className = "player-row";
                
                let badge = p.isBanned ? `<span class="badge b-banned">BANNED</span>` : `<span class="badge b-clean">CLEAN</span>`;
                let action = p.isBanned 
                    ? `<button onclick="unban('${p.productUserId}')" class="btn btn-ghost" style="color:var(--green); border-color:var(--green)">Unban</button>`
                    : `<button onclick="openModal('${p.productUserId}', '${p.username}')" class="btn btn-danger">Ban</button>`;

                div.innerHTML = `
                    <div class="p-info">
                        <div class="p-avatar">${(p.username||"?")[0].toUpperCase()}</div>
                        <div>
                            <div style="font-weight:bold; font-size:1.1em;">${p.username||"Unknown"}</div>
                            <div style="font-family:monospace; color:var(--text-dim); font-size:0.8em;">${p.productUserId}</div>
                        </div>
                    </div>
                    <div style="display:flex; gap:15px; align-items:center;">
                        <div style="font-size:0.9em; color:var(--text-dim);">üí∞ ${p.sheckles||0} | ‚öôÔ∏è ${p.scrap||0}</div>
                        ${badge}
                        ${action}
                        <button onclick="del('${p.productUserId}')" class="btn btn-ghost" style="padding:5px 10px;">X</button>
                    </div>
                `;
                l.appendChild(div);
            });
        }

        function openModal(id, name) { SEL=id; document.getElementById('m-target').innerText=name; document.getElementById('modal').style.display='flex'; }
        function closeModal() { document.getElementById('modal').style.display='none'; }

        async function commitBan() {
            if(!SEL) return;
            let r = document.getElementById('m-reason').value;
            let m = document.getElementById('m-time').value;
            await fetch(API+'/api/ban', {
                method:'POST', headers:{'Content-Type':'application/json','x-admin-auth':TOKEN},
                body:JSON.stringify({productUserId:SEL, reason:r, durationMinutes:m})
            });
            closeModal(); refresh();
        }

        async function unban(id) {
            if(confirm("Unban user?")) {
                await fetch(API+'/api/unban', {method:'POST', headers:{'Content-Type':'application/json','x-admin-auth':TOKEN}, body:JSON.stringify({productUserId:id})});
                refresh();
            }
        }
        
        async function del(id) {
            if(confirm("Delete record? This cannot be undone.")) {
                await fetch(API+'/api/delete', {method:'POST', headers:{'Content-Type':'application/json','x-admin-auth':TOKEN}, body:JSON.stringify({productUserId:id})});
                refresh();
            }
        }
    </script>
</body>
</html>
